# 浏览器渲染过程
1. 处理HTML标记并构造DOM树  
字节流->字符串->Token->node节点->DomTree  
DOM节点的数量越多，构建DOM树所需的时间就越长。当遇到一个CSS文件时，解析也可以继续进行，但是对于`<script>`标签（特别是没有 async 或者 defer 属性）会阻塞渲染并停止HTML的解析。尽管浏览器的预加载扫描器加速了这个过程，但过多的脚本仍然是一个重要的瓶颈。  
### 预加载扫描器
浏览器构建Dom时，占用了主线程。这种情况发生时，预加载扫描仪将解析可用的内容并请求高优先级资源，如CSS、JavaScript和web字体。多亏了预加载扫描器，我们不必等到解析器找到对外部资源的引用来请求它。它将在后台检索资源，以便在主HTML解析器到达请求的资源时，它们可能已经在运行，或者已经被下载。预加载扫描仪提供的优化减少了阻塞。

2. 构建cssom树
这里注意不完整的cssom tree是不能被使用的，浏览器必须等到它构建完成才会进入下一阶段
3. style  
将DOM和CSSOM组合成一个Render树，计算样式树或渲染树从DOM树的根开始构建，遍历每个可见节点。
4. layout  
在渲染树上运行布局以计算每个节点的位置和大小  
第一次确定节点的大小和位置称为布局。随后对节点大小和位置的重新计算称为回流
5. paint
最后一步是将各个节点绘制到屏幕上

## 关于阻塞
1. head 中 link 只阻塞 DOM 的渲染而不阻塞 DOM 的解析。
2. body 中的 link 会同时阻塞 DOM 的解析和渲染。
3. link 无论在 body 还是在 head 中都会阻塞 js 的执行。
4. js 会阻塞 DOM 的解析和渲染，js 在加载过程中不会卡死页面，在执行过程中会卡死页面，无法进行交互。
5. 浏览器解析到非 defer 和 async 的 script 标签会立即触发一次渲染